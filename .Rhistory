plot(colMeans(props),type='l',lwd=3,col='lightgrey',las=1,ylim=c(0,.4),axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
lines(props[i,],lwd=3)
text(7.5,.375,data$abbrv[i],cex=.8,font=2)
if (i==6|i==12|i==18|i==24|i==30|i==36|i==41) {axis(1,at=c(1,9),labels=c('1st','9th'),cex=.5)}
}
dev.off()
?text
text(7.5,.375,data$abbrv[i],cex=.8,font=2,adj=c(0,0))
par(mfcol=c(6,7))
par(mar=c(2,1,1,1))
for (i in 1:dim(props)[1]) {
plot(colMeans(props),type='l',lwd=3,col='lightgrey',las=1,ylim=c(0,.4),axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
lines(props[i,],lwd=3)
text(7.5,.375,data$abbrv[i],cex=.8,font=2,adj=c(0,0))
if (i==6|i==12|i==18|i==24|i==30|i==36|i==41) {axis(1,at=c(1,9),labels=c('1st','9th'),cex=.5)}
}
for (i in 1:dim(props)[1]) {
plot(colMeans(props),type='l',lwd=3,col='lightgrey',las=1,ylim=c(0,.4),axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
lines(props[i,],lwd=3)
text(7.5,.375,data$abbrv[i],cex=.8,font=2,adj=c(1,1))
if (i==6|i==12|i==18|i==24|i==30|i==36|i==41) {axis(1,at=c(1,9),labels=c('1st','9th'),cex=.5)}
}
for (i in 1:dim(props)[1]) {
plot(colMeans(props),type='l',lwd=3,col='lightgrey',las=1,ylim=c(0,.4),axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
lines(props[i,],lwd=3)
text(8.5,.375,data$abbrv[i],cex=.8,font=2,adj=c(1,1))
if (i==6|i==12|i==18|i==24|i==30|i==36|i==41) {axis(1,at=c(1,9),labels=c('1st','9th'),cex=.5)}
}
par(mfcol=c(6,7))
par(mar=c(2,1,1,1))
for (i in 1:dim(props)[1]) {
plot(colMeans(props),type='l',lwd=3,col='lightgrey',las=1,ylim=c(0,.4),axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
lines(props[i,],lwd=3)
text(8.5,.375,data$abbrv[i],cex=.8,font=2,adj=c(1,1))
if (i==6|i==12|i==18|i==24|i==30|i==36|i==41) {axis(1,at=c(1,9),labels=c('1st','9th'),cex=.5)}
}
svg('~/Documents/shakespeare-chronordination/test.svg',width=5,height=5)
par(mfcol=c(6,7))
par(mar=c(2,1,1,1))
for (i in 1:dim(props)[1]) {
plot(colMeans(props),type='l',lwd=3,col='lightgrey',las=1,ylim=c(0,.4),axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
lines(props[i,],lwd=3)
text(8.5,.375,data$abbrv[i],cex=.8,font=2,adj=c(1,1))
if (i==6|i==12|i==18|i==24|i==30|i==36|i==41) {axis(1,at=c(1,9),labels=c('1st','9th'),cex=.5)}
}
dev.off()
par(mfcol=c(6,7))
par(mar=c(2,1,1,1))
for (i in 1:dim(props)[1]) {
plot(colMeans(props),type='l',lwd=3,col='lightgrey',las=1,ylim=c(0,.4),axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
lines(props[i,],lwd=3)
text(8.5,.4,data$abbrv[i],cex=.8,font=2,adj=c(1,1))
if (i==6|i==12|i==18|i==24|i==30|i==36|i==41) {axis(1,at=c(1,9),labels=c('1st','9th'),cex=.5)}
}
svg('~/Documents/shakespeare-chronordination/test.svg',width=5,height=5)
par(mfcol=c(6,7))
par(mar=c(2,1,1,1))
for (i in 1:dim(props)[1]) {
plot(colMeans(props),type='l',lwd=3,col='lightgrey',las=1,ylim=c(0,.4),axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
lines(props[i,],lwd=3)
text(8.5,.4,data$abbrv[i],cex=.8,font=2,adj=c(1,1))
if (i==6|i==12|i==18|i==24|i==30|i==36|i==41) {axis(1,at=c(1,9),labels=c('1st','9th'),cex=.5)}
}
dev.off()
par(mar=c(2,1,.5,1))
for (i in 1:dim(props)[1]) {
plot(colMeans(props),type='l',lwd=3,col='lightgrey',las=1,ylim=c(0,.4),axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
lines(props[i,],lwd=3)
text(8.5,.4,data$abbrv[i],cex=.8,font=2,adj=c(1,1))
if (i==6|i==12|i==18|i==24|i==30|i==36|i==41) {axis(1,at=c(1,9),labels=c('1st','9th'),cex=.5)}
}
svg('~/Documents/shakespeare-chronordination/test.svg',width=5,height=5)
par(mfcol=c(6,7))
par(mar=c(2,1,.5,1))
for (i in 1:dim(props)[1]) {
plot(colMeans(props),type='l',lwd=3,col='lightgrey',las=1,ylim=c(0,.4),axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
lines(props[i,],lwd=3)
text(8.5,.4,data$abbrv[i],cex=.8,font=2,adj=c(1,1))
if (i==6|i==12|i==18|i==24|i==30|i==36|i==41) {axis(1,at=c(1,9),labels=c('1st','9th'),cex=.5)}
}
dev.off()
par(mfcol=c(6,7))
par(mar=c(2,1,.5,1))
for (i in 1:dim(props)[1]) {
plot(colMeans(props),type='l',lwd=3,col='lightgrey',las=1,ylim=c(0,.4),axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
lines(props[i,],lwd=3)
text(8.5,.4,data$abbrv[i],cex=.8,font=2,adj=c(1,1))
if (i==6|i==12|i==18|i==24|i==30|i==36|i==41) {axis(1,at=c(1,9),labels=c('1st','9th'),cex=.5)}
}
par(mfcol=c(1,1))
par(mar=c(5,4,2,1))
plot(props[1,],lwd=3)
plot(props[data$oxford<1593,],lwd=3,type='l',)
plot(1:9,props[data$oxford<1593,],lwd=3,type='l',)
props[data$oxford<1593,]
which(data$oxford<1593)
plot(props[1,],ylim=c0,.4)
for (i in which(data$oxford<1593))
plot(props[1,],ylim=c0,.4)
for (i in which(data$oxford<1593)) {
lines(1:9,,lwd=3,type='l')
}
plot(1:9,props[1,],ylim=c0,.4)
plot(1:9,props[1,],ylim=c(0,.4))
plot(1:9,props[1,],ylim=c(0,.4),type='n')
for (i in which(data$oxford<1593)) {
lines(1:9,,lwd=3,type='l')
}
plot(1:9,props[1,],ylim=c(0,.4),type='n')
for (i in which(data$oxford<1593)) {
lines(1:9,props[i,],lwd=3,type='l')
}
plot(1:9,props[1,],ylim=c(0,.4),type='n',las=1,axes=F)
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
for (i in which(data$oxford<1593)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
axis(2)
axis(2,las=1)
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
for (i in which(data$oxford<1593)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
axis(2,las=1)
text(8.5,.4,'Plays written before 1593'cex=.8,font=2,adj=c(1,1))
text(8.5,.4,'Plays written before 1593',cex=.8,font=2,adj=c(1,1))
par(mfcol=c(1,3))
par(mar=c(5,4,2,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
for (i in which(data$oxford<1593)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
axis(2,las=1)
text(8.5,.4,'Plays written before 1593',cex=.8,font=2,adj=c(1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
for (i in which(data$oxford>=1598 & data$oxford<=1601)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
axis(2,las=1)
text(8.5,.4,'Plays written between 1598 and 1601',cex=.8,font=2,adj=c(1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
for (i in which(data$oxford>1609)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
axis(2,las=1)
text(8.5,.4,'Plays written after 1609',cex=.8,font=2,adj=c(1,1))
par(mfcol=c(1,3))
par(mar=c(5,4,2,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford<1593)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
axis(2,las=1)
text(8.5,.4,'Plays written before 1593',cex=.8,font=2,adj=c(1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford>=1598 & data$oxford<=1601)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
#axis(2,las=1)
text(8.5,.4,'Plays written between 1598 and 1601',cex=.8,font=2,adj=c(1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford>1609)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
#axis(2,las=1)
text(8.5,.4,'Plays written after 1609',cex=.8,font=2,adj=c(1,1))
par(mar=c(5,4,1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford<1593)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
axis(2,las=1)
text(8.5,.4,'Plays written before 1593',cex=.8,font=2,adj=c(1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford>=1598 & data$oxford<=1601)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
#axis(2,las=1)
text(8.5,.4,'Plays written between 1598 and 1601',cex=.8,font=2,adj=c(1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford>1609)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
#axis(2,las=1)
text(8.5,.4,'Plays written after 1609',cex=.8,font=2,adj=c(1,1))
which(data$oxford>1609
)
which(data$oxford>=1598 & data$oxford<=1601)
i
text(8.5,.4,'Plays written between 1598 and 1601\n(6 plays)',cex=.8,font=2,adj=c(1,1))
which(data$oxford<1593)
par(mfcol=c(1,3))
par(mar=c(5,4,1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford<1593)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
axis(2,las=1)
text(8.5,.4,'Plays written before 1593\n(7 plays)',cex=.8,font=2,adj=c(1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford>=1598 & data$oxford<=1601)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
#axis(2,las=1)
text(8.5,.4,'Plays written between 1598 and 1601\n(6 plays)',cex=.8,font=2,adj=c(1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford>1609)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
#axis(2,las=1)
text(8.5,.4,'Plays written after 1609\n(4 plays)',cex=.8,font=2,adj=c(1,1))
which(data$oxford>1608)
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford>1608)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
#axis(2,las=1)
text(8.5,.4,'Plays written after 1609\n(4 plays)',cex=.8,font=2,adj=c(1,1))
which(data$oxford<1592)
hich(data$oxford=<1592)
which(data$oxford=<1592)
which(data$oxford<=1592)
which(data$oxford<1593)
data$oxford
which(data$oxford>1607)
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford>1607)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
#axis(2,las=1)
text(8.5,.4,'Plays written after 1607\n(6 plays)',cex=.8,font=2,adj=c(1,1))
par(mfcol=c(1,3))
par(mar=c(5,4,1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford<1593)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
axis(2,las=1)
text(8.5,.4,'Plays written before 1593\n(7 plays)',cex=.8,font=2,adj=c(1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford>=1598 & data$oxford<=1601)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
#axis(2,las=1)
text(8.5,.4,'Plays written between 1598 and 1601\n(6 plays)',cex=.8,font=2,adj=c(1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford>1607)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
#axis(2,las=1)
text(8.5,.4,'Plays written after 1607\n(6 plays)',cex=.8,font=2,adj=c(1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford>1607)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
#axis(2,las=1)
text(8.5,.4,'Plays written after 1607\n(6 plays)',cex=.8,font=1,adj=c(1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford>1607)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
#axis(2,las=1)
text(8.5,.4,'Plays written after 1607\n(6 plays)',cex=.8,font=3,adj=c(1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford>1607)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
#axis(2,las=1)
text(8.5,.4,'Plays written after 1607\n(6 plays)',cex=.8,font=4,adj=c(1,1))
par(mfcol=c(1,3))
par(mar=c(5,4,1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford<1593)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
axis(2,las=1)
text(8.5,.4,'Plays written before 1593\n(7 plays)',cex=.8,font=2,adj=c(1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford>=1598 & data$oxford<=1601)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
#axis(2,las=1)
text(8.5,.4,'Plays written between 1598 and 1601\n(6 plays)',cex=.8,font=2,adj=c(1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford>1607)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
#axis(2,las=1)
text(8.5,.4,'Plays written after 1607\n(6 plays)',cex=.8,font=2,adj=c(1,1))
svg('~/Documents/shakespeare-chronordination/test2.svg',width=6,height=4)
par(mfcol=c(1,3))
par(mar=c(5,4,1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford<1593)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
axis(2,las=1)
text(8.5,.4,'Plays written before 1593\n(7 plays)',cex=.8,font=2,adj=c(1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford>=1598 & data$oxford<=1601)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
#axis(2,las=1)
text(8.5,.4,'Plays written between 1598 and 1601\n(6 plays)',cex=.8,font=2,adj=c(1,1))
plot(1:9,props[1,],ylim=c(0,.4),type='n',axes=F,xlab='',ylab='')
abline(h=c(0,.2,.4),lty=2,col='lightgrey')
for (i in which(data$oxford>1607)) {
lines(1:9,props[i,],lwd=3,type='l')
}
axis(1,at=c(1,9),labels=c('1st','9th'))
#axis(2,las=1)
text(8.5,.4,'Plays written after 1607\n(6 plays)',cex=.8,font=2,adj=c(1,1))
dev.off()
boot = read.table('boots_verse.txt')
setwd("~/Documents/shakespeare-chronordination")
library(scales)
#data = read.csv('cca_prediction_march2014.csv')
data = read.csv('cca_prediction_march2014_tempest.csv')
#boot = read.table('boots.txt')
boot = read.table('boots_tempest.txt')
boot = read.table('boots_verse.txt')
names = read.csv('cca_bootstrap_play_titles.csv',header=F)
#names = read.table('raw_data_titles.txt')
names = names[,1]
boot_means = apply(boot,1,mean)
x = apply(boot,1,quantile,probs=c(.025,.975))
status = read.csv('playhouse_status_august_2013.csv')
open = status$date[status$status=='open']
close = status$date[status$status=='closed']
output = data.frame(names,boot_means,t(x))
names(output) = c('play','mean_cca','lower_95','upper_95')
combined = merge(data[,1:2],output,by.x='Title',by.y='play')
levels(combined$Title)[which(levels(combined$Title)=='ALL')] = 'AWW'
levels(combined$Title)[which(levels(combined$Title)=='KJ')] = 'JN'
levels(combined$Title)[which(levels(combined$Title)=='LEA')] = 'LR'
levels(combined$Title)[which(levels(combined$Title)=='RJ')] = 'ROM'
levels(combined$Title)[which(levels(combined$Title)=='TEM')] = 'TMP'
levels(combined$Title)[which(levels(combined$Title)=='TC')] = 'TRO'
levels(combined$Title)[which(levels(combined$Title)=='MW')] = 'WIV'
levels(combined$Title)[which(levels(combined$Title)=='WIN')] = 'WT'
plot(combined$mean_cca,pch=19,col='grey',ylim=c(1615,1590))
segments(1:41,combined$lower_95,1:41,combined$upper_95,col='grey')
points(combined$cca_prediction)
text(1:41,combined$cca_prediction+2,labels=combined$Title,cex=.5)
plot(combined$mean_cca,pch=19,col='grey',ylim=c(1615,1590))
segments(1:41,combined$lower_95,1:41,combined$upper_95,col='grey')
points(combined$cca_prediction)
text(1:41,combined$cca_prediction+2,labels=combined$Title,cex=.5)
plot(sort(combined$cca_prediction),ylim=c(1615,1590),type='n',ylab='Predicted Year from CCA',las=1)
points(1:41,combined$cca_prediction[order(combined$cca_prediction)])
anchors = which(combined$Title[order(combined$cca_prediction)]=='3H6'|combined$Title[order(combined$cca_prediction)]=='JC'|combined$Title[order(combined$cca_prediction)]=='PER')
points(c(1:41)[anchors],combined$cca_prediction[order(combined$cca_prediction)][anchors],col='black',pch=19)
for (i in 1:length(close)) {
polygon(c(0,0,41,41),c(close[i],open[i+1],open[i+1],close[i]),col=alpha('black',.1),border=NA)
}
text(1:41,sort(combined$cca_prediction)+.5,combined$Title[order(combined$cca_prediction)],cex=.5)
text(1:41,combined$cca_prediction[order(combined$cca_prediction)]+1,round(combined$cca_prediction[order(combined$cca_prediction)])-c(rep(1500,25),rep(1600,41-25)),cex=.5,adj=c(.5,1.75))
plot(sort(combined$mean_cca),ylim=c(1615,1590),type='n',ylab='Predicted Year from CCA',las=1)
#abline(h=c(1590,1600,1610),lty=3,col='lightgrey',lwd=2)
segments(c(1:41),combined$lower_95[order(combined$mean_cca)],c(1:41),combined$upper_95[order(combined$mean_cca)],col='darkgrey')
points(sort(combined$mean_cca),pch=19,col='darkgrey')
text(1:41,sort(combined$mean_cca)+2,combined$Title[order(combined$mean_cca)],cex=.5)
anchors = which(combined$Title[order(combined$mean_cca)]=='3H6'|combined$Title[order(combined$mean_cca)]=='JC'|combined$Title[order(combined$mean_cca)]=='PER')
points(c(1:41)[anchors],combined$cca_prediction[order(combined$cca_prediction)][anchors],col='black',pch=19)
for (i in 1:length(close)) {
polygon(c(0,0,41,41),c(close[i],open[i+1],open[i+1],close[i]),col=alpha('black',.1),border=NA)
}
sorted = combined[order(combined$cca_prediction),]
plot(sorted$mean_cca,pch=19,col='grey',ylim=c(1615,1590),ylab='Year',las=1)
segments(1:41,sorted$lower_95,1:41,sorted$upper_95,col='grey')
points(sorted$cca_prediction)
text(1:41,sorted$cca_prediction+1,labels=sorted$Title,cex=.5)
for (i in 1:length(close)) {
polygon(c(0,0,41,41),c(close[i],open[i+1],open[i+1],close[i]),col=alpha('black',.1),border=NA)
}
write.csv(sorted,'sorted_cca_predictions_verselines.csv',row.names=F)
dim(sorted)
reg = read.csv('sorted_cca_predictions_march2014.csv')
dim(reg)
names(reg)
names(sorted)
plot(sorted$cca_prediction,reg$cca_prediction)
abline(a=1,b=0)
abline(a=0,b=1)
plot(sorted$mean_cca,reg$mean_cca)
abline(a=0,b=1)
plot(sorted$upper_95,reg$upper_95)
abline(a=0,b=1)
plot(sorted$lower_95,reg$lower_95)
abline(a=0,b=1)
segments(1:41,sorted$upper_95,1:41,sorted$lower_95)
plot(1:41,1:41,type='n',ylim=c(1610,1590))
segments(1:41,sorted$upper_95,1:41,sorted$lower_95)
plot(1:41,1:41,type='n',ylim=c(1615,1590))
segments(1:41,sorted$upper_95,1:41,sorted$lower_95)
segments(c(1:41)+.2,reg$upper_95,c(1:41)+.2,reg$lower_95,col='red')
text(1:41,reg$upper_95+.5,reg$Title,cex=.5)
text(35,1593,'Regular')
text(35,1595,'Verse Lines',col='red')
data = read.csv('~/Documents/shakespeare-chronordination/SH DATA all counts A minus C Ed Bruster 11-5 Smith 11-15.csv')
library(scales)
library(ca)
dates = read.csv('~/Documents/shakespeare-chronordination/dates.csv')
dates = dates[,c(4,2)]
data = merge(data,dates)
data = data[order(data$oxford),]
par(mar=c(1,1,1,1))
par(mfcol=c(14,3))
for (i in 1:41){
#if (i==1|i==15|i==29){par(mar=c(2,3,2,1))} else {par(mar=c(2,1,2,1))}
vals = data[i,3:11]/sum(data[i,3:11])
plot(1:9,vals,type='n',axes=F,ylim=c(0,.4))
#gradient.rect(0,0,9,.4,reds=c(0,1),greens=c(0,1),blues=c(0,1),gradient="x",border=NA)
polygon(c(1:9,9:1),c(rep(0,9),rev(vals)),col='lightgrey',border=NA)
#axis(1,at=c(1,9))
#if (i==1|i==15|i==29){axis(2,las=1,at=c(0,.4))}
}
View(data)
?heatmap
?heatmap.2
library(gplots)
head(data)
heatmap.2(prop.table(as.matrix(data[,3:11]),1),Rowv=F,Colv=F,trace='none',key=F,keysize=.5,labRow=paste(data$oxford],data$Title],sep=', '), lmat=rbind(c(0,3,4),c(2,1,0)), lwid = c(.5,1,1),labCol=NA,col=grey(c(100:1/100)))
heatmap.2(prop.table(as.matrix(data[,3:11]),1),Rowv=F,Colv=F,trace='none',key=F,keysize=.5,labRow=paste(data$oxford,data$Title,sep=', '), lmat=rbind(c(0,3,4),c(2,1,0)), lwid = c(.5,1,1),labCol=NA,col=grey(c(100:1/100)))
heatmap.2(prop.table(as.matrix(data[,3:11]),1),Rowv=F,Colv=F,trace='none',key=F,keysize=.5,labRow=paste(data$oxford,data$Title,sep=', '), lmat=rbind(c(0,3,4),c(2,1,0)), lwid = c(.5,1,1),labCol=NA,col=grey(c(100:1/100)),dendrogram='none')
heatmap.2(prop.table(as.matrix(data[,3:11]),1),Rowv=F,Colv=F,trace='none',key=F,keysize=.5,labRow=paste(data$oxford,data$Title,sep=', '), lmat=rbind(c(0,3,4),c(2,1,0)), lwid = c(.5,1,1),labCol=NA,col=grey(c(100:1/100)),dendrogram='none')
heatmap.2(prop.table(as.matrix(data[,3:11]),1),Rowv=F,Colv=F,trace='none',key=F,keysize=.5,labRow=paste(data$Title,sep=', '), lmat=rbind(c(0,3,4),c(2,1,0)), lwid = c(.5,1,1),labCol=NA,col=grey(c(100:1/100)),dendrogram='none')
heatmap.2(prop.table(as.matrix(data[,3:11]),1),Rowv=F,Colv=F,trace='none',key=F,keysize=.5,labRow=paste(data$Title,data$oxford,sep=', '), lmat=rbind(c(0,3,4),c(2,1,0)), lwid = c(.5,1,1),labCol=NA,col=grey(c(100:1/100)),dendrogram='none')
heatmap.2(prop.table(as.matrix(data[,3:11]),1),Rowv=F,Colv=F,trace='none',key=F,keysize=.5,labRow=paste(data$Title,data$oxford,sep='\t '), lmat=rbind(c(0,3,4),c(2,1,0)), lwid = c(.5,1,1),labCol=NA,col=grey(c(100:1/100)),dendrogram='none')
?paste
heatmap.2(prop.table(as.matrix(data[,3:11]),1),Rowv=F,Colv=F,trace='none',key=F,keysize=.5,labRow=paste(data$Title,data$oxford,sep="\t "), lmat=rbind(c(0,3,4),c(2,1,0)), lwid = c(.5,1,1),labCol=NA,col=grey(c(100:1/100)),dendrogram='none')
heatmap.2(prop.table(as.matrix(data[,3:11]),1),Rowv=F,Colv=F,trace='none',key=F,keysize=.5,labRow=paste(data$Title,data$oxford,sep=", "), lmat=rbind(c(0,3,4),c(2,1,0)), lwid = c(.5,1,1),labCol=NA,col=grey(c(100:1/100)),dendrogram='none')
#axis(1,at = seq(.115,.4,length.out=9),labels=c(1:9),cex.axis=.5,lty=0)
#axis(1)
legend(.85,.35,col=grey(seq(0,1,.1)),legend=c('100 %',rep('',4),'50 %',rep('',4),'0%'),box.lty=0,cex=.5,pch=15,y.intersp=.95,pt.cex=1.25,title='Proportion\nof pauses\n')
legend(.85,.35,col=grey(seq(0,1,.1)),legend=c('100 %',rep('',4),'50 %',rep('',4),'0%'),box.lty=0,cex=.5,pch=15,y.intersp=.5,pt.cex=1.25,title='Proportion\nof pauses\n')
heatmap.2(prop.table(as.matrix(data[,3:11]),1),Rowv=F,Colv=F,trace='none',key=F,keysize=.5,labRow=paste(data$Title,data$oxford,sep=", "), lmat=rbind(c(0,3,4),c(2,1,0)), lwid = c(.5,1,1),labCol=NA,col=grey(c(100:1/100)),dendrogram='none')
#axis(1,at = seq(.115,.4,length.out=9),labels=c(1:9),cex.axis=.5,lty=0)
#axis(1)
legend(.85,.35,col=grey(seq(0,1,.1)),legend=c('100 %',rep('',4),'50 %',rep('',4),'0%'),box.lty=0,cex=.5,pch=15,y.intersp=.7,pt.cex=1.25,title='Proportion\nof pauses\n')
svg("~/Documents/shakespeare-chronordination/heatmap_bw.svg")
heatmap.2(prop.table(as.matrix(data[,3:11]),1),Rowv=F,Colv=F,trace='none',key=F,keysize=.5,labRow=paste(data$Title,data$oxford,sep=", "), lmat=rbind(c(0,3,4),c(2,1,0)), lwid = c(.5,1,1),labCol=NA,col=grey(c(100:1/100)),dendrogram='none')
#axis(1,at = seq(.115,.4,length.out=9),labels=c(1:9),cex.axis=.5,lty=0)
#axis(1)
legend(.85,.35,col=grey(seq(0,1,.1)),legend=c('100 %',rep('',4),'50 %',rep('',4),'0%'),box.lty=0,cex=.5,pch=15,y.intersp=.7,pt.cex=1.25,title='Proportion\nof pauses\n')
dev.off()
svg("~/Documents/shakespeare-chronordination/heatmap_bw.svg",width=5)
heatmap.2(prop.table(as.matrix(data[,3:11]),1),Rowv=F,Colv=F,trace='none',key=F,keysize=.5,labRow=paste(data$Title,data$oxford,sep=", "), lmat=rbind(c(0,3,4),c(2,1,0)), lwid = c(.5,1,1),labCol=NA,col=grey(c(100:1/100)),dendrogram='none')
#axis(1,at = seq(.115,.4,length.out=9),labels=c(1:9),cex.axis=.5,lty=0)
#axis(1)
legend(.85,.35,col=grey(seq(0,1,.1)),legend=c('100 %',rep('',4),'50 %',rep('',4),'0%'),box.lty=0,cex=.5,pch=15,y.intersp=.7,pt.cex=1.25,title='Proportion\nof pauses\n')
dev.off()
